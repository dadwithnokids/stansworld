<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Stanley's Desk</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Chicago&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --mac-gray: #c0c0c0;
    --mac-dark: #808080;
    --mac-darker: #404040;
    --mac-white: #ffffff;
    --mac-black: #000000;
    --mac-title: #000080;
  }

  /* ‚îÄ‚îÄ ROTATE PROMPT ‚îÄ‚îÄ */
  #rotate-prompt {
    display: none;
    position: fixed; inset: 0;
    background: #000;
    color: #fff;
    font-family: 'Courier New', monospace;
    font-size: 1.1rem;
    text-align: center;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    gap: 1.5rem;
  }
  #rotate-prompt .rotate-icon {
    font-size: 3rem;
    animation: rotateAnim 2s ease-in-out infinite;
  }
  @keyframes rotateAnim {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(90deg); }
  }
  @media (orientation: portrait) and (max-width: 768px) {
    #rotate-prompt { display: flex; }
    body { overflow: hidden; }
  }

  /* ‚îÄ‚îÄ BODY / SCENE ‚îÄ‚îÄ */
  body {
    width: 100vw; height: 100vh;
    overflow: hidden;
    background: #2a1a0a;
    font-family: 'Courier New', monospace;
    cursor: none; /* hide default cursor */
  }

  #scene {
    position: relative;
    width: 100%; height: 100%;
    background: url('Desk_Image.png') center/cover no-repeat;
    background-color: #0d0a08;
  }

  /* Subtle vignette to deepen edges */
  #scene::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 50% 45%, transparent 40%, rgba(0,0,0,0.35) 100%);
    pointer-events: none;
  }

  /* ‚îÄ‚îÄ CUSTOM CURSOR (pixelated hand PNG) ‚îÄ‚îÄ */
  #cursor {
    position: fixed;
    width: 36px; height: 36px;
    pointer-events: none;
    z-index: 99999;
    transform: translate(-10px, -4px);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
  }
  #cursor img {
    width: 100%; height: 100%;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    display: block;
  }
  #cursor.pointing { transform: translate(-10px, -4px) scale(1.1); }
  /* Hide custom cursor on touch devices */
  @media (hover: none), (pointer: coarse) {
    #cursor { display: none !important; }
    body { cursor: auto !important; }
    .hotspot { cursor: pointer !important; }
  }

  /* ‚îÄ‚îÄ HOTSPOTS ‚îÄ‚îÄ */
  .hotspot {
    position: absolute;
    cursor: none;
  }
  .hotspot svg, .hotspot img {
    display: block;
    image-rendering: pixelated;
    max-width: 100%;
    filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.6));
    transition: filter 0.15s;
    transform-origin: bottom center;
  }
  /* On hover: quick nudge right then settle */
  .hotspot.hovered svg,
  .hotspot.hovered img {
    filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.6)) brightness(1.15);
    animation: hotspot-nudge 0.35s steps(1, end) forwards;
  }
  @keyframes hotspot-nudge {
    0%   { transform: translateX(0px); }
    20%  { transform: translateX(4px); }
    40%  { transform: translateX(6px); }
    60%  { transform: translateX(4px); }
    80%  { transform: translateX(2px); }
    100% { transform: translateX(3px); }
  }

  /* ‚îÄ‚îÄ SPARKLE CANVAS ‚îÄ‚îÄ */
  #sparkle-canvas {
    position: fixed; inset: 0;
    pointer-events: none;
    z-index: 500;  /* below window (1000) and overlay (999) */
  }

  /* ‚îÄ‚îÄ MAC OS CLASSIC MODAL ‚îÄ‚îÄ */
  .mac-window {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    width: min(600px, 90vw);
    max-height: 80vh;
    background: var(--mac-gray);
    border: 2px solid var(--mac-black);
    box-shadow:
      inset 1px 1px 0 var(--mac-white),
      inset -1px -1px 0 var(--mac-dark),
      2px 2px 0 var(--mac-black),
      4px 4px 0 rgba(0,0,0,0.3);
    z-index: 1000;
    font-family: 'Geneva', 'Charcoal', 'Chicago', 'Courier New', monospace;
    font-size: 12px;
    image-rendering: pixelated;
    transform-origin: center center; /* overridden by JS at open time */
  }
  /* Force cursor:none on everything inside the window ‚Äî prevents double cursor */
  .mac-window, .mac-window * {
    cursor: none !important;
  }

  /* Window starts hidden; JS controls visibility during zoom-rect animation */
  .mac-window.active {
    display: block;
  }
  /* .closing is only used briefly while canvas pop plays ‚Äî no CSS anim needed */
  .mac-window.closing { display: none; }

  /* Zoom-rect canvas sits over everything during open animation */
  #zoom-rect-canvas {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1100;
    image-rendering: pixelated;
  }

  /* Title bar */
  .mac-titlebar {
    background: var(--mac-black);
    color: var(--mac-white);
    display: flex;
    align-items: center;
    padding: 3px 6px;
    gap: 6px;
    user-select: none;
    cursor: move;
  }
  .mac-close-btn {
    width: 12px; height: 12px;
    background: var(--mac-gray);
    border: 1px solid var(--mac-black);
    box-shadow: inset 1px 1px 0 var(--mac-white);
    cursor: pointer;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    font-size: 9px; font-weight: bold;
  }
  .mac-close-btn:hover { background: #ff6666; }
  .mac-close-btn::after { content: '√ó'; line-height: 1; }

  .mac-title {
    flex: 1;
    text-align: center;
    font-size: 11px;
    font-weight: bold;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* Striped title bar lines (Mac OS classic detail) */
  .mac-titlebar-stripes {
    position: absolute;
    top: 0; left: 28px; right: 28px;
    height: 100%;
    background: repeating-linear-gradient(
      90deg,
      transparent 0px,
      transparent 1px,
      var(--mac-dark) 1px,
      var(--mac-dark) 2px
    );
    opacity: 0.3;
    pointer-events: none;
  }

  /* Scrollable content area */
  .mac-content {
    overflow-y: auto;
    max-height: calc(80vh - 80px);
    padding: 12px;
    background: var(--mac-white);
    margin: 4px;
    border: 1px solid var(--mac-dark);
    box-shadow: inset 1px 1px 0 var(--mac-darker);
  }

  .mac-content h2 {
    font-size: 14px;
    font-weight: bold;
    border-bottom: 1px solid var(--mac-dark);
    padding-bottom: 4px;
    margin-bottom: 8px;
  }
  .mac-content p {
    margin-bottom: 8px;
    line-height: 1.5;
  }
  .mac-content img {
    width: 100%;
    margin: 8px 0;
    border: 1px solid var(--mac-dark);
  }
  .mac-content .project-img-row {
    display: flex; gap: 6px; margin: 8px 0;
  }
  .mac-content .project-img-row img {
    width: 50%; margin: 0;
  }

  /* Bottom bar */
  .mac-footer {
    padding: 6px 10px;
    border-top: 1px solid var(--mac-dark);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--mac-gray);
  }
  .mac-link {
    color: var(--mac-black);
    text-decoration: underline;
    cursor: pointer;
    font-size: 11px;
    padding: 2px 6px;
    background: var(--mac-gray);
    border: 1px solid var(--mac-black);
    box-shadow: inset 1px 1px 0 var(--mac-white), 1px 1px 0 var(--mac-darker);
  }
  .mac-link:hover {
    background: var(--mac-black);
    color: var(--mac-white);
  }
  .mac-link:active {
    box-shadow: inset 1px 1px 0 var(--mac-darker);
  }

  /* Scrollbar styling */
  .mac-content::-webkit-scrollbar { width: 14px; }
  .mac-content::-webkit-scrollbar-track {
    background: var(--mac-gray);
    border-left: 1px solid var(--mac-dark);
  }
  .mac-content::-webkit-scrollbar-thumb {
    background: var(--mac-gray);
    border: 1px solid var(--mac-dark);
    box-shadow: inset 1px 1px 0 var(--mac-white);
  }

  /* ‚îÄ‚îÄ OVERLAY ‚îÄ‚îÄ */
  #overlay {
    display: none;
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: 999;
  }
  #overlay.active { display: block; }

  /* ‚îÄ‚îÄ DEMO DESK OBJECTS (placeholders) ‚îÄ‚îÄ */
  .demo-label {
    position: absolute;
    color: rgba(255,255,220,0.5);
    font-size: 10px;
    font-family: 'Courier New', monospace;
    pointer-events: none;
    text-align: center;
    transform: translateX(-50%);
  }

  /* ‚îÄ‚îÄ HOVER LABEL ‚îÄ‚îÄ */
  #hover-label {
    position: fixed;
    background: #ffff99;
    border: 1px solid #000;
    padding: 2px 6px;
    font-size: 11px;
    font-family: 'Courier New', monospace;
    pointer-events: none;
    z-index: 9997;
    display: none;
    white-space: nowrap;
  }
</style>
</head>
<body>

<!-- ROTATE PROMPT -->
<div id="rotate-prompt">
  <div class="rotate-icon">üì±</div>
  <p>Please rotate your device<br>to landscape mode to view this site.</p>
</div>

<!-- CUSTOM CURSOR -->
<div id="cursor"><img src="cursor.png" alt=""></div>

<!-- HOVER TOOLTIP -->
<div id="hover-label"></div>

<!-- SPARKLE CANVAS -->
<canvas id="sparkle-canvas"></canvas>
<canvas id="zoom-rect-canvas"></canvas>

<!-- SCENE -->
<div id="scene">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       HOTSPOTS ‚Äî edit these!
       Each .hotspot needs:
         data-project="project-id"
         data-label="Hover label text"
         style="left: X%; top: Y%; width: W%"
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

  <!-- 
    HOTSPOT POSITIONS ‚Äî tuned to the actual desk image.
    Desk surface safe zone: left 5%‚Äì90%, top 45%‚Äì88%
    Lit center area: left 30%‚Äì75%, top 48%‚Äì75%
  -->

  <!-- HOTSPOT 1: Snacktion Box ‚Äî left side of desk -->
  <div class="hotspot" 
       data-project="snacktion" 
       data-label="Snacktion Set"
       style="left: 18%; top: 53%; width: 10%;">
    <svg viewBox="0 0 100 130" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="10" y="10" width="80" height="110" rx="4" fill="#e8c840" stroke="#8a7020" stroke-width="2"/>
      <rect x="15" y="20" width="70" height="50" fill="#cc3333"/>
      <text x="50" y="50" text-anchor="middle" font-size="10" fill="white" font-weight="bold">SNACKTION</text>
      <text x="50" y="62" text-anchor="middle" font-size="7" fill="white">BEEF JERKY</text>
      <rect x="15" y="80" width="70" height="30" fill="#444" rx="2"/>
      <text x="50" y="99" text-anchor="middle" font-size="7" fill="#ffcc00">‚òÖ LEVEL UP ‚òÖ</text>
    </svg>
  </div>

  <!-- HOTSPOT 2: Boombox ‚Äî center-right of desk, lying flat -->
  <div class="hotspot" 
       data-project="boombox" 
       data-label="Boombox Jerky Line"
       style="left: 48%; top: 60%; width: 18%;">
    <svg viewBox="0 0 140 80" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="5" y="15" width="130" height="55" rx="8" fill="#111" stroke="#444" stroke-width="2"/>
      <circle cx="30" cy="42" r="18" fill="#222" stroke="#666" stroke-width="2"/>
      <circle cx="30" cy="42" r="10" fill="#333" stroke="#555"/>
      <circle cx="30" cy="42" r="3" fill="#888"/>
      <circle cx="110" cy="42" r="18" fill="#222" stroke="#666" stroke-width="2"/>
      <circle cx="110" cy="42" r="10" fill="#333" stroke="#555"/>
      <circle cx="110" cy="42" r="3" fill="#888"/>
      <rect x="55" y="25" width="30" height="18" rx="2" fill="#333" stroke="#555"/>
      <rect x="58" y="28" width="24" height="12" fill="#111"/>
      <rect x="55" y="48" width="6" height="6" rx="1" fill="#cc0000"/>
      <rect x="64" y="48" width="6" height="6" rx="1" fill="#444"/>
      <rect x="73" y="48" width="6" height="6" rx="1" fill="#444"/>
      <rect x="82" y="48" width="6" height="6" rx="1" fill="#444"/>
    </svg>
  </div>

  <!-- HOTSPOT 3: Monitor / Entrapnet ‚Äî back of desk, near window -->
  <div class="hotspot" 
       data-project="entrapnet" 
       data-label="Entrapnet ‚Äî Win95 Browser Emulator"
       style="left: 34%; top: 28%; width: 14%;">
    <svg viewBox="0 0 140 120" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="10" y="5" width="120" height="85" rx="6" fill="#c8c8c0" stroke="#888" stroke-width="2"/>
      <rect x="18" y="13" width="104" height="65" fill="#001a00"/>
      <text x="70" y="38" text-anchor="middle" font-size="9" fill="#00cc00" font-family="monospace">C:\&gt;_</text>
      <text x="70" y="50" text-anchor="middle" font-size="7" fill="#00aa00" font-family="monospace">ENTRAPNT.EXE</text>
      <text x="70" y="62" text-anchor="middle" font-size="6" fill="#008800" font-family="monospace">Loading...</text>
      <rect x="50" y="90" width="40" height="8" rx="2" fill="#aaa" stroke="#888"/>
      <rect x="55" y="98" width="30" height="16" rx="1" fill="#aaa" stroke="#888"/>
    </svg>
  </div>

  <!-- HOTSPOT 4: Gentleman's Mist ‚Äî right side of desk, standing upright -->
  <div class="hotspot" 
       data-project="gentlemans-mist" 
       data-label="Gentleman's Mist"
       style="left: 74%; top: 46%; width: 5%;">
    <svg viewBox="0 0 50 110" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="15" y="5" width="20" height="10" rx="3" fill="#888"/>
      <rect x="18" y="15" width="14" height="5" fill="#777"/>
      <rect x="8" y="20" width="34" height="80" rx="4" fill="#1a3a5c" stroke="#0a2040" stroke-width="1.5"/>
      <rect x="12" y="30" width="26" height="50" rx="2" fill="rgba(255,255,255,0.08)"/>
      <text x="25" y="55" text-anchor="middle" font-size="5" fill="#c8d8e8">GENTLEMAN'S</text>
      <text x="25" y="63" text-anchor="middle" font-size="4" fill="#c8d8e8">MIST</text>
      <rect x="10" y="85" width="30" height="8" rx="1" fill="#0a2040" opacity="0.5"/>
    </svg>
  </div>

</div><!-- /scene -->

<!-- ‚ïê‚ïê OVERLAY ‚ïê‚ïê -->
<div id="overlay"></div>

<!-- ‚ïê‚ïê PROJECT WINDOWS ‚ïê‚ïê -->

<!-- Snacktion Set -->
<div class="mac-window" id="window-snacktion">
  <div class="mac-titlebar" data-window="snacktion">
    <div class="mac-close-btn" data-close="snacktion"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Snacktion Set</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>üéÆ Snacktion Set</h2>
    <p>A Nintendo-inspired beef jerky packaging line. Each box in the set is themed around classic gaming ‚Äî complete with pixel-art aesthetics, level-up messaging, and a collectible feel.</p>
    <p>The packaging was designed to evoke nostalgia while standing out on the shelf. Each SKU corresponds to a "game genre" with its own color palette and visual language.</p>
    <div class="project-img-row">
      <img src="https://placehold.co/260x180/cc3333/ffcc00?text=Snacktion+Front" alt="Snacktion front">
      <img src="https://placehold.co/260x180/222244/00ff88?text=Snacktion+Back" alt="Snacktion back">
    </div>
    <p>Available online and at select retailers. Started as a side experiment ‚Äî turned into a full product line.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk ¬© 2024</span>
    <a class="mac-link" href="https://yoursnacksite.com" target="_blank" rel="noopener">‚Üó View Project</a>
  </div>
</div>

<!-- Boombox Jerky -->
<div class="mac-window" id="window-boombox">
  <div class="mac-titlebar" data-window="boombox">
    <div class="mac-close-btn" data-close="boombox"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Boombox Jerky Line</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>üìª Boombox Series</h2>
    <p>The next evolution of the themed jerky line ‚Äî a boombox-inspired packaging series leaning into 80s hip-hop, street culture, and that heavy chrome aesthetic.</p>
    <p>Currently in development. Each flavor maps to a different "frequency" ‚Äî the packaging acts as a collectible piece you'd want displayed, not just eaten.</p>
    <img src="https://placehold.co/560x220/111111/ff6600?text=Boombox+Series+Concept" alt="Boombox concept">
    <p>Target launch: 2025. Testing three SKUs initially.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk ¬© 2024</span>
    <a class="mac-link" href="https://yoursite.com/boombox" target="_blank" rel="noopener">‚Üó View Project</a>
  </div>
</div>

<!-- Entrapnet -->
<div class="mac-window" id="window-entrapnet">
  <div class="mac-titlebar" data-window="entrapnet">
    <div class="mac-close-btn" data-close="entrapnet"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Entrapnet ‚Äî Win95 Emulator</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>üíæ Entrapnet Browser Emulator</h2>
    <p>A fully playable Windows 95 environment that runs in your browser ‚Äî built using the v86 emulator, configured to auto-boot and launch ENTRAPNT.EXE on load.</p>
    <p>The project involved overcoming multiple GitHub Pages deployment challenges, custom BIOS configuration, and optimizing load times for the disk image. The result is a dead-accurate DOS/Win95 experience that needs no installation.</p>
    <img src="https://placehold.co/560x200/001a00/00cc00?text=C%3A%5C%3E+ENTRAPNT.EXE" alt="Entrapnet running">
    <p>Playable on Archive.org. The concept: resurrect a forgotten piece of digital history and make it accessible to anyone with a browser.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk ¬© 2024</span>
    <a class="mac-link" href="https://archive.org/details/entrapnet" target="_blank" rel="noopener">‚Üó Play on Archive.org</a>
  </div>
</div>

<!-- Gentleman's Mist -->
<div class="mac-window" id="window-gentlemans-mist">
  <div class="mac-titlebar" data-window="gentlemans-mist">
    <div class="mac-close-btn" data-close="gentlemans-mist"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Gentleman's Mist</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>üß¥ Gentleman's Mist</h2>
    <p>A handcrafted men's grooming body spray developed from scratch ‚Äî formulated with essential oils sourced from India, scaled for both barber shop wholesale and direct online retail.</p>
    <p>The project involved complete cost structure analysis across two bottle sizes (780 units), fragrance development, and building a pricing model that works at both the barber shop and consumer level.</p>
    <img src="https://placehold.co/560x180/1a3a5c/c8d8e8?text=Gentleman's+Mist" alt="Gentleman's Mist bottle">
    <p>Handmade in Louisville, KY. The scent profile leans woody, clean, and understated ‚Äî something that smells expensive without performing for a room.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk ¬© 2024</span>
    <a class="mac-link" href="https://yourmistsite.com" target="_blank" rel="noopener">‚Üó View Project</a>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CURSOR TRACKING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const cursor = document.getElementById('cursor');
document.addEventListener('mousemove', e => {
  cursor.style.left = e.clientX + 'px';
  cursor.style.top = e.clientY + 'px';
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SPARKLE SYSTEM ‚Äî single burst on hover-enter
// Grows from 1 small diamond ‚Üí 3-4 pixel diamonds, quick
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const canvas = document.getElementById('sparkle-canvas');
const ctx = canvas.getContext('2d');
let sparkles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// Each sparkle: exactly 3 sprite frames ‚Äî small ‚Üí full ‚Üí small ‚Üí gone
class PixelDiamond {
  constructor(x, y, delay) {
    this.x = x;
    this.y = y;
    this.delay = delay;
    this.age = -delay;
    this.duration = 52;          // ~0.87s at 60fps ‚Äî nice and slow
    this.ox = (Math.random() - 0.5) * 18;
    this.oy = (Math.random() - 0.5) * 14;
    this.vy = -0.18 - Math.random() * 0.18; // gentle upward drift
    const colors = ['#ffffff', '#ffe87c', '#ffd700', '#fff0a0', '#c8f0ff', '#ffccff'];
    this.color = colors[Math.floor(Math.random() * colors.length)];
    this.maxSize = Math.floor(Math.random() * 2 + 2); // 2, 3, or 4px
  }

  done() { return this.age > this.duration; }

  draw(ctx) {
    this.age++;
    if (this.age <= 0) return;

    const t = this.age / this.duration;

    // Hard 3-frame stepped size (no smooth tween ‚Äî stays pixel-art)
    let s, alpha;
    if      (t < 0.33) { s = Math.max(1, Math.round(this.maxSize * 0.5)); alpha = 1.0; }  // frame 1: small
    else if (t < 0.66) { s = this.maxSize;                                  alpha = 1.0; }  // frame 2: full
    else if (t < 0.83) { s = Math.max(1, Math.round(this.maxSize * 0.5)); alpha = 0.6; }  // frame 3: small+dim
    else               { return; }                                                            // gone

    this.oy += this.vy;
    const px = Math.round(this.x + this.ox);
    const py = Math.round(this.y + this.oy);

    ctx.globalAlpha = alpha;
    ctx.fillStyle = this.color;

    ctx.fillRect(px, py, s, s); // center pixel
    for (let i = 1; i <= s + 1; i++) {
      const arm = Math.max(1, s - Math.floor(i * 0.4));
      ctx.fillRect(px + i * s, py, arm, arm);
      ctx.fillRect(px - i * s, py, arm, arm);
      ctx.fillRect(px, py - i * s, arm, arm);
      ctx.fillRect(px, py + i * s, arm, arm);
    }
    ctx.globalAlpha = 1;
  }
}

function spawnBurstAt(el) {
  const rect = el.getBoundingClientRect();
  const cx = rect.left + rect.width / 2;
  const cy = rect.top  + rect.height / 3;
  // Exactly 3 sparkles, staggered 10 frames apart (~0.16s each)
  for (let i = 0; i < 3; i++) {
    sparkles.push(new PixelDiamond(cx, cy, i * 10));
  }
}

function animateSparkles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  sparkles.forEach(s => s.draw(ctx));
  sparkles = sparkles.filter(s => !s.done());
  requestAnimationFrame(animateSparkles);
}
animateSparkles();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HOTSPOT HOVER & CLICK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const hoverLabel = document.getElementById('hover-label');
let activeHotspot = null;

document.querySelectorAll('.hotspot').forEach(hotspot => {
  hotspot.addEventListener('mouseenter', () => {
    activeHotspot = hotspot;
    cursor.classList.add('pointing');
    hoverLabel.style.display = 'block';
    hoverLabel.textContent = hotspot.dataset.label || '';
    hotspot.classList.add('hovered');
    // Single burst ‚Äî fire once on enter
    spawnBurstAt(hotspot);
  });

  hotspot.addEventListener('mousemove', e => {
    hoverLabel.style.left = (e.clientX + 20) + 'px';
    hoverLabel.style.top = (e.clientY - 10) + 'px';
  });

  hotspot.addEventListener('mouseleave', () => {
    activeHotspot = null;
    cursor.classList.remove('pointing');
    hoverLabel.style.display = 'none';
    hotspot.classList.remove('hovered');
  });

  hotspot.addEventListener('click', () => {
    const projectId = hotspot.dataset.project;
    openWindow(projectId, hotspot);
  });
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WINDOW MANAGEMENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const overlay = document.getElementById('overlay');

// ‚îÄ‚îÄ ZOOM RECT CANVAS ‚îÄ‚îÄ
// Draws the classic Mac-style animated outline rectangle that zooms
// from the hotspot to the window's final position before revealing content.
const zoomCanvas = document.getElementById('zoom-rect-canvas');
const zoomCtx = zoomCanvas.getContext('2d');
function resizeZoomCanvas() {
  zoomCanvas.width  = window.innerWidth;
  zoomCanvas.height = window.innerHeight;
}
resizeZoomCanvas();
window.addEventListener('resize', resizeZoomCanvas);

function animateZoomRect(fromRect, toRect, onDone) {
  // fromRect / toRect: { x, y, w, h } in viewport coords
  const DURATION = 340;  // ms ‚Äî feels like a real old Mac
  const start = performance.now();

  // Dashed line pattern ‚Äî 4px on, 4px off, very pixel-y
  const DASH = [4, 4];
  let dashOffset = 0;

  function frame(now) {
    const elapsed = now - start;
    let t = Math.min(elapsed / DURATION, 1);

    // Ease: fast start, decelerates ‚Äî classic Mac feel
    t = 1 - Math.pow(1 - t, 2.4);

    // Interpolate rect
    const x = fromRect.x + (toRect.x - fromRect.x) * t;
    const y = fromRect.y + (toRect.y - fromRect.y) * t;
    const w = fromRect.w + (toRect.w - fromRect.w) * t;
    const h = fromRect.h + (toRect.h - fromRect.h) * t;

    zoomCtx.clearRect(0, 0, zoomCanvas.width, zoomCanvas.height);

    const rx = Math.round(x), ry = Math.round(y);
    const rw = Math.round(w), rh = Math.round(h);

    // Soft fill ‚Äî Mac gray tint that fades in as the rect grows.
    // fillAlpha goes 0 ‚Üí 0.18 over the animation so it feels like
    // the window body is materialising behind the outline.
    const fillAlpha = t * 0.18;
    zoomCtx.globalAlpha = fillAlpha;
    zoomCtx.fillStyle = '#c8c8c8';
    zoomCtx.fillRect(rx, ry, rw, rh);
    zoomCtx.globalAlpha = 1;

    // Marching-ants outline ‚Äî outer black
    zoomCtx.strokeStyle = '#000000';
    zoomCtx.lineWidth = 2;
    zoomCtx.setLineDash(DASH);
    zoomCtx.lineDashOffset = -dashOffset;
    zoomCtx.strokeRect(rx, ry, rw, rh);

    // Inner white offset ‚Äî double-outline pixel look
    zoomCtx.strokeStyle = '#ffffff';
    zoomCtx.lineWidth = 1;
    zoomCtx.lineDashOffset = -dashOffset - 4;
    zoomCtx.strokeRect(rx + 1, ry + 1, rw - 2, rh - 2);

    zoomCtx.setLineDash([]); // reset

    dashOffset = (dashOffset + 1.5) % 8; // march the ants

    if (t < 1) {
      requestAnimationFrame(frame);
    } else {
      zoomCtx.clearRect(0, 0, zoomCanvas.width, zoomCanvas.height);
      onDone();
    }
  }

  requestAnimationFrame(frame);
}

// ‚îÄ‚îÄ Z-INDEX MANAGER ‚îÄ‚îÄ
// Each time a window is clicked or opened it gets the highest z-index
// so it floats above all others. Base is 1000, increments up.
let topZ = 1000;
function bringToFront(win) {
  topZ++;
  win.style.zIndex = topZ;
}

// Stagger offset so multiple windows don't open perfectly stacked
let openCount = 0;

function openWindow(id, originEl) {
  const win = document.getElementById('window-' + id);
  if (!win) return;

  // If already open, just bring to front ‚Äî don't re-animate
  if (win.classList.contains('active')) {
    bringToFront(win);
    return;
  }

  // Measure window height off-screen
  win.style.visibility = 'hidden';
  win.style.display = 'block';
  const winW = Math.min(600, window.innerWidth * 0.9);
  const winH = Math.min(win.offsetHeight, window.innerHeight * 0.8);
  win.style.display = 'none';
  win.style.visibility = '';

  // Cascade offset ‚Äî each new window opens slightly offset from center
  // so stacked windows are visibly separate
  const cascade = (openCount % 5) * 22; // 0, 22, 44, 66, 88 px
  openCount++;

  const toRect = {
    x: (window.innerWidth  - winW) / 2 + cascade,
    y: (window.innerHeight - winH) / 2 + cascade,
    w: winW,
    h: winH,
  };

  let fromRect;
  if (originEl) {
    const r = originEl.getBoundingClientRect();
    fromRect = { x: r.left, y: r.top, w: r.width, h: r.height };
  } else {
    fromRect = {
      x: window.innerWidth  / 2 - 4,
      y: window.innerHeight / 2 - 4,
      w: 8, h: 8
    };
  }

  animateZoomRect(fromRect, toRect, () => {
    // Position at the cascaded location using absolute px (not % + transform)
    // so drag works cleanly from the start without any coordinate system switch
    win.style.transform  = 'none';
    win.style.left       = toRect.x + 'px';
    win.style.top        = toRect.y + 'px';
    win.style.opacity    = '0';
    win.style.transition = '';
    win.classList.remove('closing');
    win.style.display    = 'block';
    bringToFront(win);
    void win.offsetWidth;
    win.style.transition = 'opacity 0.18s ease-out';
    win.style.opacity    = '1';

    setTimeout(() => {
      win.style.transition = '';
      win.classList.add('active');
    }, 200);
  });
}

function dissolveWindow(rect, titlebarH) {
  // Cover the window area with a grid of small tiles.
  // Each tile gets a random "death time" ‚Äî when progress passes it,
  // that tile drops out. Result: window appears to dissolve pixel by pixel.

  const TILE      = 4;     // px per dissolve pixel ‚Äî small and grainy
  const DURATION  = 2200;  // ms total
  const cols = Math.ceil(rect.width  / TILE);
  const rows = Math.ceil(rect.height / TILE);

  // Assign each tile a random dropout time (0..1) with slight spatial noise
  // so adjacent tiles don't all die together ‚Äî pure random looks most digital
  const tiles = [];
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const sx = rect.left + c * TILE;
      const sy = rect.top  + r * TILE;

      // Color: approximate what the window actually looks like in this region
      // Title bar = near-black, content area = light gray/white
      const inTitlebar = (sy - rect.top) < titlebarH;
      const v = inTitlebar
        ? Math.floor(Math.random() * 40)          // dark  0-40
        : 180 + Math.floor(Math.random() * 75);   // light 180-255
      const color = `rgb(${v},${v},${v})`;

      tiles.push({
        sx, sy,
        color,
        // Each tile dies at a uniformly random time across the full duration
        // Small gaussian-ish nudge: average of 3 randoms = slightly clustered
        // around midpoint but with full spread ‚Äî feels organic not mechanical
        deathT: (Math.random() + Math.random() + Math.random()) / 3,
        alpha: 1,
      });
    }
  }

  const start = performance.now();

  function drawFrame(now) {
    const elapsed  = now - start;
    const progress = Math.min(elapsed / DURATION, 1);

    // Ease: slow start, accelerates ‚Äî pixels start dropping slowly
    // then it all falls apart quickly at the end
    const ease = Math.pow(progress, 0.75);

    zoomCtx.clearRect(0, 0, zoomCanvas.width, zoomCanvas.height);

    let anyAlive = false;
    tiles.forEach(tile => {
      // How far past this tile's death time are we?
      if (ease >= tile.deathT) {
        // Tile is dying ‚Äî fade it out over a short window after its death time
        const fadeRange = 0.08;
        const fadeProgress = (ease - tile.deathT) / fadeRange;
        tile.alpha = Math.max(0, 1 - fadeProgress);
      }

      if (tile.alpha <= 0) return;
      anyAlive = true;

      zoomCtx.globalAlpha = tile.alpha;
      zoomCtx.fillStyle   = tile.color;
      zoomCtx.fillRect(tile.sx, tile.sy, TILE, TILE);
    });

    zoomCtx.globalAlpha = 1;

    if (anyAlive && progress < 1) {
      requestAnimationFrame(drawFrame);
    } else {
      zoomCtx.clearRect(0, 0, zoomCanvas.width, zoomCanvas.height);
    }
  }

  requestAnimationFrame(drawFrame);
}

function closeWindow(id) {
  const win = document.getElementById('window-' + id);
  if (!win) return;

  const rect      = win.getBoundingClientRect();
  const titlebarH = win.querySelector('.mac-titlebar')?.offsetHeight || 20;

  // Hide the real window immediately ‚Äî canvas dissolve takes over
  win.classList.remove('active', 'closing');
  win.style.display    = 'none';
  win.style.left       = '';
  win.style.top        = '';
  win.style.transform  = '';
  win.style.zIndex     = '';

  // Run the pixel dissolve on the zoom canvas
  dissolveWindow(rect, titlebarH);

  const anyOpen = document.querySelectorAll('.mac-window.active').length > 0;
  if (!anyOpen) overlay.classList.remove('active');
}

// Close buttons
document.querySelectorAll('.mac-close-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    closeWindow(btn.dataset.close);
  });
});

// No overlay click-to-close ‚Äî windows stay open until X is clicked.
// Overlay is now just a subtle dim behind the topmost window.

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DRAGGABLE WINDOWS + BRING TO FRONT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// Single shared drag state ‚Äî only one window drags at a time
let dragState = null;

// Attach drag to a window element (called for both static + dynamic windows)
function makeDraggable(win) {
  const titlebar = win.querySelector('.mac-titlebar');
  if (!titlebar) return;

  // Clicking anywhere on the window brings it to front
  win.addEventListener('mousedown', () => bringToFront(win));

  titlebar.addEventListener('mousedown', e => {
    if (e.target.classList.contains('mac-close-btn')) return;
    e.preventDefault();
    bringToFront(win);

    const rect = win.getBoundingClientRect();
    // Windows are positioned with absolute left/top px ‚Äî read directly
    dragState = {
      win,
      startX: e.clientX - rect.left,
      startY: e.clientY - rect.top,
    };
  });
}

document.addEventListener('mousemove', e => {
  if (!dragState) return;
  dragState.win.style.left = (e.clientX - dragState.startX) + 'px';
  dragState.win.style.top  = (e.clientY - dragState.startY) + 'px';
});

document.addEventListener('mouseup', () => { dragState = null; });

// Attach to all static windows on load
document.querySelectorAll('.mac-window').forEach(makeDraggable);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADDING NEW HOTSPOTS via JSON config
// (Paste your JSON in the array below to add projects without coding)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
/*
  HOW TO ADD A NEW PROJECT:
  Add an object to the PROJECTS array below:

  {
    id: "my-new-project",
    label: "My New Project",         // hover tooltip
    left: "60%",                     // horizontal position on desk
    top: "55%",                      // vertical position on desk  
    width: "10%",                    // size
    imageSrc: "path/to/image.png",   // your desk object image
    title: "My New Project",
    description: "Describe it here...",
    images: ["img1.jpg", "img2.jpg"],
    link: "https://myproject.com",
    linkText: "View Project"
  }
*/
const PROJECTS = [
  // Add new projects here ‚Äî they'll be auto-rendered on page load
];

function buildProjectFromConfig(project) {
  // Create hotspot
  const hotspot = document.createElement('div');
  hotspot.className = 'hotspot';
  hotspot.dataset.project = project.id;
  hotspot.dataset.label = project.label;
  hotspot.style.left = project.left;
  hotspot.style.top = project.top;
  hotspot.style.width = project.width || '10%';

  if (project.imageSrc) {
    const img = document.createElement('img');
    img.src = project.imageSrc;
    img.alt = project.label;
    hotspot.appendChild(img);
  }

  document.getElementById('scene').appendChild(hotspot);

  // Create window
  const win = document.createElement('div');
  win.className = 'mac-window';
  win.id = 'window-' + project.id;

  const imgRows = (project.images || []).map(src =>
    `<img src="${src}" alt="${project.title}">`
  ).join('');

  win.innerHTML = `
    <div class="mac-titlebar" data-window="${project.id}">
      <div class="mac-close-btn" data-close="${project.id}"></div>
      <div style="position:relative;flex:1;text-align:center;">
        <div class="mac-titlebar-stripes"></div>
        <span class="mac-title">${project.title}</span>
      </div>
      <div style="width:12px;"></div>
    </div>
    <div class="mac-content">
      <h2>${project.title}</h2>
      ${imgRows}
      <p>${project.description}</p>
    </div>
    <div class="mac-footer">
      <span style="font-size:10px;color:#666;">Stanley's Desk ¬© 2024</span>
      ${project.link ? `<a class="mac-link" href="${project.link}" target="_blank" rel="noopener">‚Üó ${project.linkText || 'View Project'}</a>` : ''}
    </div>
  `;
  document.body.appendChild(win);

  // Attach events
  hotspot.addEventListener('mouseenter', () => {
    activeHotspot = hotspot;
    cursor.classList.add('pointing');
    hoverLabel.style.display = 'block';
    hoverLabel.textContent = hotspot.dataset.label;
    hotspot.classList.add('hovered');
    spawnBurstAt(hotspot);
  });
  hotspot.addEventListener('mousemove', e => {
    hoverLabel.style.left = (e.clientX + 20) + 'px';
    hoverLabel.style.top = (e.clientY - 10) + 'px';
  });
  hotspot.addEventListener('mouseleave', () => {
    activeHotspot = null;
    cursor.classList.remove('pointing');
    hoverLabel.style.display = 'none';
    hotspot.classList.remove('hovered');
  });
  hotspot.addEventListener('click', () => openWindow(project.id, hotspot));

  win.querySelector('.mac-close-btn').addEventListener('click', () => closeWindow(project.id));

  // Make draggable + bring-to-front using the shared drag system
  makeDraggable(win);
}

PROJECTS.forEach(buildProjectFromConfig);
</script>
</body>
</html>
