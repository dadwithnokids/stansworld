<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Stanley's Desk</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Chicago&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --mac-gray: #c0c0c0;
    --mac-dark: #808080;
    --mac-darker: #404040;
    --mac-white: #ffffff;
    --mac-black: #000000;
    --mac-title: #000080;
  }

  /* â”€â”€ ROTATE PROMPT â”€â”€ */
  #rotate-prompt {
    display: none;
    position: fixed; inset: 0;
    background: #000;
    color: #fff;
    font-family: 'Courier New', monospace;
    font-size: 1.1rem;
    text-align: center;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    gap: 1.5rem;
  }
  #rotate-prompt .rotate-icon {
    font-size: 3rem;
    animation: rotateAnim 2s ease-in-out infinite;
  }
  @keyframes rotateAnim {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(90deg); }
  }
  @media (orientation: portrait) and (max-width: 768px) {
    #rotate-prompt { display: flex; }
    body { overflow: hidden; }
  }

  /* â”€â”€ BODY / SCENE â”€â”€ */
  body {
    width: 100vw; height: 100vh;
    overflow: hidden;
    background: #2a1a0a;
    font-family: 'Courier New', monospace;
    cursor: none; /* hide default cursor */
  }

  #scene {
    position: relative;
    width: 100%; height: 100%;
    background: url('Desk_Image.png') center/cover no-repeat;
    background-color: #0d0a08;
  }

  /* Subtle vignette to deepen edges */
  #scene::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 50% 45%, transparent 40%, rgba(0,0,0,0.35) 100%);
    pointer-events: none;
  }

  /* â”€â”€ CUSTOM CURSOR (pixelated hand PNG) â”€â”€ */
  #cursor {
    position: fixed;
    width: 36px; height: 36px;
    pointer-events: none;
    z-index: 99999;
    transform: translate(-10px, -4px);
    image-rendering: pixelated;
    image-rendering: crisp-edges;
  }
  #cursor img {
    width: 100%; height: 100%;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    display: block;
  }
  #cursor.pointing { transform: translate(-10px, -4px) scale(1.1); }
  /* Hide custom cursor on touch devices */
  @media (hover: none), (pointer: coarse) {
    #cursor { display: none !important; }
    body { cursor: auto !important; }
    .hotspot { cursor: pointer !important; }
  }

  /* â”€â”€ HOTSPOTS â”€â”€ */
  .hotspot {
    position: absolute;
    cursor: none;
  }
  .hotspot svg, .hotspot img {
    display: block;
    image-rendering: pixelated;
    max-width: 100%;
    filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.6));
    transition: filter 0.15s;
    transform-origin: bottom center;
  }
  /* On hover: quick nudge right then settle */
  .hotspot.hovered svg,
  .hotspot.hovered img {
    filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.6)) brightness(1.15);
    animation: hotspot-nudge 0.35s steps(1, end) forwards;
  }
  @keyframes hotspot-nudge {
    0%   { transform: translateX(0px); }
    20%  { transform: translateX(4px); }
    40%  { transform: translateX(6px); }
    60%  { transform: translateX(4px); }
    80%  { transform: translateX(2px); }
    100% { transform: translateX(3px); }
  }

  /* â”€â”€ SPARKLE CANVAS â”€â”€ */
  #sparkle-canvas {
    position: fixed; inset: 0;
    pointer-events: none;
    z-index: 9998;
  }

  /* â”€â”€ MAC OS CLASSIC MODAL â”€â”€ */
  .mac-window {
    display: none;
    position: fixed;
    top: 50%; left: 50%;
    width: min(600px, 90vw);
    max-height: 80vh;
    background: var(--mac-gray);
    border: 2px solid var(--mac-black);
    box-shadow:
      inset 1px 1px 0 var(--mac-white),
      inset -1px -1px 0 var(--mac-dark),
      2px 2px 0 var(--mac-black),
      4px 4px 0 rgba(0,0,0,0.3);
    z-index: 1000;
    font-family: 'Geneva', 'Charcoal', 'Chicago', 'Courier New', monospace;
    font-size: 12px;
    image-rendering: pixelated;
    transform-origin: center center; /* overridden by JS at open time */
  }
  .mac-window.active {
    display: block;
    animation: win-open 0.72s steps(7, end) forwards;
  }
  .mac-window.closing {
    display: block;
    animation: win-close 0.36s steps(4, end) forwards;
  }

  /* Lo-fi open: choppy steps, window snaps between sizes like a bad frame rate */
  @keyframes win-open {
    0%   { transform: var(--win-translate) scale(0.04); opacity: 0.9; filter: brightness(4) saturate(0) blur(1px); }
    14%  { transform: var(--win-translate) scale(0.15); opacity: 1;   filter: brightness(3) saturate(0); }
    28%  { transform: var(--win-translate) scale(0.15); opacity: 0.7; filter: brightness(2.5) saturate(0); }
    42%  { transform: var(--win-translate) scale(0.38); opacity: 1;   filter: brightness(2) saturate(0.2); }
    56%  { transform: var(--win-translate) scale(0.38); opacity: 0.6; filter: brightness(1.6) saturate(0.4); }
    70%  { transform: var(--win-translate) scale(0.72); opacity: 1;   filter: brightness(1.2) saturate(0.7); }
    84%  { transform: var(--win-translate) scale(0.72); opacity: 0.8; filter: brightness(1.1); }
    100% { transform: var(--win-translate) scale(1.0);  opacity: 1;   filter: brightness(1); }
  }

  /* Lo-fi close: snaps back in big jumps */
  @keyframes win-close {
    0%   { transform: var(--win-translate) scale(1.0);  opacity: 1;   filter: brightness(1); }
    30%  { transform: var(--win-translate) scale(0.55); opacity: 1;   filter: brightness(1.8) saturate(0.3); }
    60%  { transform: var(--win-translate) scale(0.55); opacity: 0.5; filter: brightness(2.5) saturate(0); }
    85%  { transform: var(--win-translate) scale(0.08); opacity: 0.8; filter: brightness(3) saturate(0); }
    100% { transform: var(--win-translate) scale(0.0);  opacity: 0; }
  }

  /* Echo ghost â€” faint afterimage that trails behind the opening window */
  .mac-window-echo {
    position: fixed;
    pointer-events: none;
    z-index: 999;
    background: var(--mac-gray);
    border: 2px solid var(--mac-black);
    width: min(600px, 90vw);
    image-rendering: pixelated;
  }
  @keyframes win-echo {
    0%   { transform: var(--win-translate) scale(0.04); opacity: 0.5; filter: brightness(3) saturate(0); }
    40%  { transform: var(--win-translate) scale(0.28); opacity: 0.3; filter: brightness(2); }
    70%  { transform: var(--win-translate) scale(0.55); opacity: 0.15;}
    100% { transform: var(--win-translate) scale(0.90); opacity: 0;  }
  }

  /* Title bar */
  .mac-titlebar {
    background: var(--mac-black);
    color: var(--mac-white);
    display: flex;
    align-items: center;
    padding: 3px 6px;
    gap: 6px;
    user-select: none;
    cursor: move;
  }
  .mac-close-btn {
    width: 12px; height: 12px;
    background: var(--mac-gray);
    border: 1px solid var(--mac-black);
    box-shadow: inset 1px 1px 0 var(--mac-white);
    cursor: pointer;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    font-size: 9px; font-weight: bold;
  }
  .mac-close-btn:hover { background: #ff6666; }
  .mac-close-btn::after { content: 'Ã—'; line-height: 1; }

  .mac-title {
    flex: 1;
    text-align: center;
    font-size: 11px;
    font-weight: bold;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* Striped title bar lines (Mac OS classic detail) */
  .mac-titlebar-stripes {
    position: absolute;
    top: 0; left: 28px; right: 28px;
    height: 100%;
    background: repeating-linear-gradient(
      90deg,
      transparent 0px,
      transparent 1px,
      var(--mac-dark) 1px,
      var(--mac-dark) 2px
    );
    opacity: 0.3;
    pointer-events: none;
  }

  /* Scrollable content area */
  .mac-content {
    overflow-y: auto;
    max-height: calc(80vh - 80px);
    padding: 12px;
    background: var(--mac-white);
    margin: 4px;
    border: 1px solid var(--mac-dark);
    box-shadow: inset 1px 1px 0 var(--mac-darker);
  }

  .mac-content h2 {
    font-size: 14px;
    font-weight: bold;
    border-bottom: 1px solid var(--mac-dark);
    padding-bottom: 4px;
    margin-bottom: 8px;
  }
  .mac-content p {
    margin-bottom: 8px;
    line-height: 1.5;
  }
  .mac-content img {
    width: 100%;
    margin: 8px 0;
    border: 1px solid var(--mac-dark);
  }
  .mac-content .project-img-row {
    display: flex; gap: 6px; margin: 8px 0;
  }
  .mac-content .project-img-row img {
    width: 50%; margin: 0;
  }

  /* Bottom bar */
  .mac-footer {
    padding: 6px 10px;
    border-top: 1px solid var(--mac-dark);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--mac-gray);
  }
  .mac-link {
    color: var(--mac-black);
    text-decoration: underline;
    cursor: pointer;
    font-size: 11px;
    padding: 2px 6px;
    background: var(--mac-gray);
    border: 1px solid var(--mac-black);
    box-shadow: inset 1px 1px 0 var(--mac-white), 1px 1px 0 var(--mac-darker);
  }
  .mac-link:hover {
    background: var(--mac-black);
    color: var(--mac-white);
  }
  .mac-link:active {
    box-shadow: inset 1px 1px 0 var(--mac-darker);
  }

  /* Scrollbar styling */
  .mac-content::-webkit-scrollbar { width: 14px; }
  .mac-content::-webkit-scrollbar-track {
    background: var(--mac-gray);
    border-left: 1px solid var(--mac-dark);
  }
  .mac-content::-webkit-scrollbar-thumb {
    background: var(--mac-gray);
    border: 1px solid var(--mac-dark);
    box-shadow: inset 1px 1px 0 var(--mac-white);
  }

  /* â”€â”€ OVERLAY â”€â”€ */
  #overlay {
    display: none;
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: 999;
  }
  #overlay.active { display: block; }

  /* â”€â”€ DEMO DESK OBJECTS (placeholders) â”€â”€ */
  .demo-label {
    position: absolute;
    color: rgba(255,255,220,0.5);
    font-size: 10px;
    font-family: 'Courier New', monospace;
    pointer-events: none;
    text-align: center;
    transform: translateX(-50%);
  }

  /* â”€â”€ HOVER LABEL â”€â”€ */
  #hover-label {
    position: fixed;
    background: #ffff99;
    border: 1px solid #000;
    padding: 2px 6px;
    font-size: 11px;
    font-family: 'Courier New', monospace;
    pointer-events: none;
    z-index: 9997;
    display: none;
    white-space: nowrap;
  }
</style>
</head>
<body>

<!-- ROTATE PROMPT -->
<div id="rotate-prompt">
  <div class="rotate-icon">ðŸ“±</div>
  <p>Please rotate your device<br>to landscape mode to view this site.</p>
</div>

<!-- CUSTOM CURSOR -->
<div id="cursor"><img src="cursor.png" alt=""></div>

<!-- HOVER TOOLTIP -->
<div id="hover-label"></div>

<!-- SPARKLE CANVAS -->
<canvas id="sparkle-canvas"></canvas>

<!-- SCENE -->
<div id="scene">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HOTSPOTS â€” edit these!
       Each .hotspot needs:
         data-project="project-id"
         data-label="Hover label text"
         style="left: X%; top: Y%; width: W%"
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- 
    HOTSPOT POSITIONS â€” tuned to the actual desk image.
    Desk surface safe zone: left 5%â€“90%, top 45%â€“88%
    Lit center area: left 30%â€“75%, top 48%â€“75%
  -->

  <!-- HOTSPOT 1: Snacktion Box â€” left side of desk -->
  <div class="hotspot" 
       data-project="snacktion" 
       data-label="Snacktion Set"
       style="left: 18%; top: 53%; width: 10%;">
    <svg viewBox="0 0 100 130" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="10" y="10" width="80" height="110" rx="4" fill="#e8c840" stroke="#8a7020" stroke-width="2"/>
      <rect x="15" y="20" width="70" height="50" fill="#cc3333"/>
      <text x="50" y="50" text-anchor="middle" font-size="10" fill="white" font-weight="bold">SNACKTION</text>
      <text x="50" y="62" text-anchor="middle" font-size="7" fill="white">BEEF JERKY</text>
      <rect x="15" y="80" width="70" height="30" fill="#444" rx="2"/>
      <text x="50" y="99" text-anchor="middle" font-size="7" fill="#ffcc00">â˜… LEVEL UP â˜…</text>
    </svg>
  </div>

  <!-- HOTSPOT 2: Boombox â€” center-right of desk, lying flat -->
  <div class="hotspot" 
       data-project="boombox" 
       data-label="Boombox Jerky Line"
       style="left: 48%; top: 60%; width: 18%;">
    <svg viewBox="0 0 140 80" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="5" y="15" width="130" height="55" rx="8" fill="#111" stroke="#444" stroke-width="2"/>
      <circle cx="30" cy="42" r="18" fill="#222" stroke="#666" stroke-width="2"/>
      <circle cx="30" cy="42" r="10" fill="#333" stroke="#555"/>
      <circle cx="30" cy="42" r="3" fill="#888"/>
      <circle cx="110" cy="42" r="18" fill="#222" stroke="#666" stroke-width="2"/>
      <circle cx="110" cy="42" r="10" fill="#333" stroke="#555"/>
      <circle cx="110" cy="42" r="3" fill="#888"/>
      <rect x="55" y="25" width="30" height="18" rx="2" fill="#333" stroke="#555"/>
      <rect x="58" y="28" width="24" height="12" fill="#111"/>
      <rect x="55" y="48" width="6" height="6" rx="1" fill="#cc0000"/>
      <rect x="64" y="48" width="6" height="6" rx="1" fill="#444"/>
      <rect x="73" y="48" width="6" height="6" rx="1" fill="#444"/>
      <rect x="82" y="48" width="6" height="6" rx="1" fill="#444"/>
    </svg>
  </div>

  <!-- HOTSPOT 3: Monitor / Entrapnet â€” back of desk, near window -->
  <div class="hotspot" 
       data-project="entrapnet" 
       data-label="Entrapnet â€” Win95 Browser Emulator"
       style="left: 34%; top: 28%; width: 14%;">
    <svg viewBox="0 0 140 120" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="10" y="5" width="120" height="85" rx="6" fill="#c8c8c0" stroke="#888" stroke-width="2"/>
      <rect x="18" y="13" width="104" height="65" fill="#001a00"/>
      <text x="70" y="38" text-anchor="middle" font-size="9" fill="#00cc00" font-family="monospace">C:\&gt;_</text>
      <text x="70" y="50" text-anchor="middle" font-size="7" fill="#00aa00" font-family="monospace">ENTRAPNT.EXE</text>
      <text x="70" y="62" text-anchor="middle" font-size="6" fill="#008800" font-family="monospace">Loading...</text>
      <rect x="50" y="90" width="40" height="8" rx="2" fill="#aaa" stroke="#888"/>
      <rect x="55" y="98" width="30" height="16" rx="1" fill="#aaa" stroke="#888"/>
    </svg>
  </div>

  <!-- HOTSPOT 4: Gentleman's Mist â€” right side of desk, standing upright -->
  <div class="hotspot" 
       data-project="gentlemans-mist" 
       data-label="Gentleman's Mist"
       style="left: 74%; top: 46%; width: 5%;">
    <svg viewBox="0 0 50 110" xmlns="http://www.w3.org/2000/svg" style="width:100%">
      <rect x="15" y="5" width="20" height="10" rx="3" fill="#888"/>
      <rect x="18" y="15" width="14" height="5" fill="#777"/>
      <rect x="8" y="20" width="34" height="80" rx="4" fill="#1a3a5c" stroke="#0a2040" stroke-width="1.5"/>
      <rect x="12" y="30" width="26" height="50" rx="2" fill="rgba(255,255,255,0.08)"/>
      <text x="25" y="55" text-anchor="middle" font-size="5" fill="#c8d8e8">GENTLEMAN'S</text>
      <text x="25" y="63" text-anchor="middle" font-size="4" fill="#c8d8e8">MIST</text>
      <rect x="10" y="85" width="30" height="8" rx="1" fill="#0a2040" opacity="0.5"/>
    </svg>
  </div>

</div><!-- /scene -->

<!-- â•â• OVERLAY â•â• -->
<div id="overlay"></div>

<!-- â•â• PROJECT WINDOWS â•â• -->

<!-- Snacktion Set -->
<div class="mac-window" id="window-snacktion">
  <div class="mac-titlebar" data-window="snacktion">
    <div class="mac-close-btn" data-close="snacktion"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Snacktion Set</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>ðŸŽ® Snacktion Set</h2>
    <p>A Nintendo-inspired beef jerky packaging line. Each box in the set is themed around classic gaming â€” complete with pixel-art aesthetics, level-up messaging, and a collectible feel.</p>
    <p>The packaging was designed to evoke nostalgia while standing out on the shelf. Each SKU corresponds to a "game genre" with its own color palette and visual language.</p>
    <div class="project-img-row">
      <img src="https://placehold.co/260x180/cc3333/ffcc00?text=Snacktion+Front" alt="Snacktion front">
      <img src="https://placehold.co/260x180/222244/00ff88?text=Snacktion+Back" alt="Snacktion back">
    </div>
    <p>Available online and at select retailers. Started as a side experiment â€” turned into a full product line.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk Â© 2024</span>
    <a class="mac-link" href="https://yoursnacksite.com" target="_blank" rel="noopener">â†— View Project</a>
  </div>
</div>

<!-- Boombox Jerky -->
<div class="mac-window" id="window-boombox">
  <div class="mac-titlebar" data-window="boombox">
    <div class="mac-close-btn" data-close="boombox"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Boombox Jerky Line</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>ðŸ“» Boombox Series</h2>
    <p>The next evolution of the themed jerky line â€” a boombox-inspired packaging series leaning into 80s hip-hop, street culture, and that heavy chrome aesthetic.</p>
    <p>Currently in development. Each flavor maps to a different "frequency" â€” the packaging acts as a collectible piece you'd want displayed, not just eaten.</p>
    <img src="https://placehold.co/560x220/111111/ff6600?text=Boombox+Series+Concept" alt="Boombox concept">
    <p>Target launch: 2025. Testing three SKUs initially.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk Â© 2024</span>
    <a class="mac-link" href="https://yoursite.com/boombox" target="_blank" rel="noopener">â†— View Project</a>
  </div>
</div>

<!-- Entrapnet -->
<div class="mac-window" id="window-entrapnet">
  <div class="mac-titlebar" data-window="entrapnet">
    <div class="mac-close-btn" data-close="entrapnet"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Entrapnet â€” Win95 Emulator</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>ðŸ’¾ Entrapnet Browser Emulator</h2>
    <p>A fully playable Windows 95 environment that runs in your browser â€” built using the v86 emulator, configured to auto-boot and launch ENTRAPNT.EXE on load.</p>
    <p>The project involved overcoming multiple GitHub Pages deployment challenges, custom BIOS configuration, and optimizing load times for the disk image. The result is a dead-accurate DOS/Win95 experience that needs no installation.</p>
    <img src="https://placehold.co/560x200/001a00/00cc00?text=C%3A%5C%3E+ENTRAPNT.EXE" alt="Entrapnet running">
    <p>Playable on Archive.org. The concept: resurrect a forgotten piece of digital history and make it accessible to anyone with a browser.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk Â© 2024</span>
    <a class="mac-link" href="https://archive.org/details/entrapnet" target="_blank" rel="noopener">â†— Play on Archive.org</a>
  </div>
</div>

<!-- Gentleman's Mist -->
<div class="mac-window" id="window-gentlemans-mist">
  <div class="mac-titlebar" data-window="gentlemans-mist">
    <div class="mac-close-btn" data-close="gentlemans-mist"></div>
    <div style="position:relative;flex:1;text-align:center;">
      <div class="mac-titlebar-stripes"></div>
      <span class="mac-title">Gentleman's Mist</span>
    </div>
    <div style="width:12px;"></div>
  </div>
  <div class="mac-content">
    <h2>ðŸ§´ Gentleman's Mist</h2>
    <p>A handcrafted men's grooming body spray developed from scratch â€” formulated with essential oils sourced from India, scaled for both barber shop wholesale and direct online retail.</p>
    <p>The project involved complete cost structure analysis across two bottle sizes (780 units), fragrance development, and building a pricing model that works at both the barber shop and consumer level.</p>
    <img src="https://placehold.co/560x180/1a3a5c/c8d8e8?text=Gentleman's+Mist" alt="Gentleman's Mist bottle">
    <p>Handmade in Louisville, KY. The scent profile leans woody, clean, and understated â€” something that smells expensive without performing for a room.</p>
  </div>
  <div class="mac-footer">
    <span style="font-size:10px; color:#666;">Stanley's Desk Â© 2024</span>
    <a class="mac-link" href="https://yourmistsite.com" target="_blank" rel="noopener">â†— View Project</a>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CURSOR TRACKING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const cursor = document.getElementById('cursor');
document.addEventListener('mousemove', e => {
  cursor.style.left = e.clientX + 'px';
  cursor.style.top = e.clientY + 'px';
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SPARKLE SYSTEM â€” single burst on hover-enter
// Grows from 1 small diamond â†’ 3-4 pixel diamonds, quick
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('sparkle-canvas');
const ctx = canvas.getContext('2d');
let sparkles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// Each sparkle: exactly 3 sprite frames â€” small â†’ full â†’ small â†’ gone
class PixelDiamond {
  constructor(x, y, delay) {
    this.x = x;
    this.y = y;
    this.delay = delay;
    this.age = -delay;
    this.duration = 52;          // ~0.87s at 60fps â€” nice and slow
    this.ox = (Math.random() - 0.5) * 18;
    this.oy = (Math.random() - 0.5) * 14;
    this.vy = -0.18 - Math.random() * 0.18; // gentle upward drift
    const colors = ['#ffffff', '#ffe87c', '#ffd700', '#fff0a0', '#c8f0ff', '#ffccff'];
    this.color = colors[Math.floor(Math.random() * colors.length)];
    this.maxSize = Math.floor(Math.random() * 2 + 2); // 2, 3, or 4px
  }

  done() { return this.age > this.duration; }

  draw(ctx) {
    this.age++;
    if (this.age <= 0) return;

    const t = this.age / this.duration;

    // Hard 3-frame stepped size (no smooth tween â€” stays pixel-art)
    let s, alpha;
    if      (t < 0.33) { s = Math.max(1, Math.round(this.maxSize * 0.5)); alpha = 1.0; }  // frame 1: small
    else if (t < 0.66) { s = this.maxSize;                                  alpha = 1.0; }  // frame 2: full
    else if (t < 0.83) { s = Math.max(1, Math.round(this.maxSize * 0.5)); alpha = 0.6; }  // frame 3: small+dim
    else               { return; }                                                            // gone

    this.oy += this.vy;
    const px = Math.round(this.x + this.ox);
    const py = Math.round(this.y + this.oy);

    ctx.globalAlpha = alpha;
    ctx.fillStyle = this.color;

    ctx.fillRect(px, py, s, s); // center pixel
    for (let i = 1; i <= s + 1; i++) {
      const arm = Math.max(1, s - Math.floor(i * 0.4));
      ctx.fillRect(px + i * s, py, arm, arm);
      ctx.fillRect(px - i * s, py, arm, arm);
      ctx.fillRect(px, py - i * s, arm, arm);
      ctx.fillRect(px, py + i * s, arm, arm);
    }
    ctx.globalAlpha = 1;
  }
}

function spawnBurstAt(el) {
  const rect = el.getBoundingClientRect();
  const cx = rect.left + rect.width / 2;
  const cy = rect.top  + rect.height / 3;
  // Exactly 3 sparkles, staggered 10 frames apart (~0.16s each)
  for (let i = 0; i < 3; i++) {
    sparkles.push(new PixelDiamond(cx, cy, i * 10));
  }
}

function animateSparkles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  sparkles.forEach(s => s.draw(ctx));
  sparkles = sparkles.filter(s => !s.done());
  requestAnimationFrame(animateSparkles);
}
animateSparkles();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HOTSPOT HOVER & CLICK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const hoverLabel = document.getElementById('hover-label');
let activeHotspot = null;

document.querySelectorAll('.hotspot').forEach(hotspot => {
  hotspot.addEventListener('mouseenter', () => {
    activeHotspot = hotspot;
    cursor.classList.add('pointing');
    hoverLabel.style.display = 'block';
    hoverLabel.textContent = hotspot.dataset.label || '';
    hotspot.classList.add('hovered');
    // Single burst â€” fire once on enter
    spawnBurstAt(hotspot);
  });

  hotspot.addEventListener('mousemove', e => {
    hoverLabel.style.left = (e.clientX + 20) + 'px';
    hoverLabel.style.top = (e.clientY - 10) + 'px';
  });

  hotspot.addEventListener('mouseleave', () => {
    activeHotspot = null;
    cursor.classList.remove('pointing');
    hoverLabel.style.display = 'none';
    hotspot.classList.remove('hovered');
  });

  hotspot.addEventListener('click', () => {
    const projectId = hotspot.dataset.project;
    openWindow(projectId, hotspot);
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WINDOW MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const overlay = document.getElementById('overlay');

function openWindow(id, originEl) {
  const win = document.getElementById('window-' + id);
  if (!win) return;

  // Close any already-open windows first
  document.querySelectorAll('.mac-window.active, .mac-window.closing').forEach(w => {
    w.classList.remove('active', 'closing');
    w.style.display = 'none';
  });
  // Remove any lingering echo ghosts
  document.querySelectorAll('.mac-window-echo').forEach(e => e.remove());

  // â”€â”€ COMPUTE ORIGIN â”€â”€
  // The window is centered via translate(-50%,-50%) from top:50% left:50%.
  // We need transform-origin expressed in px relative to the window element,
  // pointing at the center of the clicked hotspot.
  let originX = '50%', originY = '50%'; // fallback: screen center

  if (originEl) {
    const rect = originEl.getBoundingClientRect();
    const hotCX = rect.left + rect.width  / 2; // hotspot center in viewport px
    const hotCY = rect.top  + rect.height / 2;

    // Window's final rendered size & position
    const winW = Math.min(600, window.innerWidth  * 0.9);
    // Height unknown until rendered â€” use a reasonable estimate
    const winH = Math.min(500, window.innerHeight * 0.8);
    const winLeft = (window.innerWidth  - winW) / 2;
    const winTop  = (window.innerHeight - winH) / 2;

    // Transform-origin in window-local coords
    originX = (hotCX - winLeft) + 'px';
    originY = (hotCY - winTop)  + 'px';
  }

  win.style.transformOrigin = `${originX} ${originY}`;
  // Also store as CSS var so keyframes can reference translate separately
  win.style.setProperty('--win-translate', 'translate(-50%, -50%)');

  // â”€â”€ ECHO GHOST â”€â”€ faint afterimage that lags behind the opening window
  const echo = document.createElement('div');
  echo.className = 'mac-window-echo';
  echo.style.top  = '50%';
  echo.style.left = '50%';
  echo.style.maxHeight = '80vh';
  echo.style.transformOrigin = `${originX} ${originY}`;
  echo.style.setProperty('--win-translate', 'translate(-50%, -50%)');
  echo.style.animation = 'win-echo 0.72s steps(7, end) forwards';
  // Echo is just a blank shell â€” same size, no content
  echo.style.height = win.offsetHeight ? win.offsetHeight + 'px' : '400px';
  document.body.appendChild(echo);
  setTimeout(() => echo.remove(), 750);

  win.classList.remove('closing');
  win.style.display = '';
  void win.offsetWidth; // force reflow
  win.classList.add('active');
  overlay.classList.add('active');
}

function closeWindow(id) {
  const win = document.getElementById('window-' + id);
  if (!win) return;
  win.classList.remove('active');
  win.classList.add('closing');
  overlay.classList.remove('active');
  setTimeout(() => { win.classList.remove('closing'); win.style.display = 'none'; }, 400);
}

// Close buttons
document.querySelectorAll('.mac-close-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    closeWindow(btn.dataset.close);
  });
});

// Overlay click to close
overlay.addEventListener('click', () => {
  document.querySelectorAll('.mac-window.active').forEach(w => {
    w.classList.remove('active');
  });
  overlay.classList.remove('active');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DRAGGABLE WINDOWS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.mac-titlebar').forEach(titlebar => {
  let isDragging = false;
  let startX, startY, startLeft, startTop;
  const win = titlebar.closest('.mac-window');

  titlebar.addEventListener('mousedown', e => {
    if (e.target.classList.contains('mac-close-btn')) return;
    isDragging = true;
    const rect = win.getBoundingClientRect();
    // Switch from transform to absolute positioning
    win.style.transform = 'none';
    win.style.left = rect.left + 'px';
    win.style.top = rect.top + 'px';
    startX = e.clientX - rect.left;
    startY = e.clientY - rect.top;
    e.preventDefault();
  });

  document.addEventListener('mousemove', e => {
    if (!isDragging) return;
    win.style.left = (e.clientX - startX) + 'px';
    win.style.top = (e.clientY - startY) + 'px';
  });

  document.addEventListener('mouseup', () => {
    isDragging = false;
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADDING NEW HOTSPOTS via JSON config
// (Paste your JSON in the array below to add projects without coding)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/*
  HOW TO ADD A NEW PROJECT:
  Add an object to the PROJECTS array below:

  {
    id: "my-new-project",
    label: "My New Project",         // hover tooltip
    left: "60%",                     // horizontal position on desk
    top: "55%",                      // vertical position on desk  
    width: "10%",                    // size
    imageSrc: "path/to/image.png",   // your desk object image
    title: "My New Project",
    description: "Describe it here...",
    images: ["img1.jpg", "img2.jpg"],
    link: "https://myproject.com",
    linkText: "View Project"
  }
*/
const PROJECTS = [
  // Add new projects here â€” they'll be auto-rendered on page load
];

function buildProjectFromConfig(project) {
  // Create hotspot
  const hotspot = document.createElement('div');
  hotspot.className = 'hotspot';
  hotspot.dataset.project = project.id;
  hotspot.dataset.label = project.label;
  hotspot.style.left = project.left;
  hotspot.style.top = project.top;
  hotspot.style.width = project.width || '10%';

  if (project.imageSrc) {
    const img = document.createElement('img');
    img.src = project.imageSrc;
    img.alt = project.label;
    hotspot.appendChild(img);
  }

  document.getElementById('scene').appendChild(hotspot);

  // Create window
  const win = document.createElement('div');
  win.className = 'mac-window';
  win.id = 'window-' + project.id;

  const imgRows = (project.images || []).map(src =>
    `<img src="${src}" alt="${project.title}">`
  ).join('');

  win.innerHTML = `
    <div class="mac-titlebar" data-window="${project.id}">
      <div class="mac-close-btn" data-close="${project.id}"></div>
      <div style="position:relative;flex:1;text-align:center;">
        <div class="mac-titlebar-stripes"></div>
        <span class="mac-title">${project.title}</span>
      </div>
      <div style="width:12px;"></div>
    </div>
    <div class="mac-content">
      <h2>${project.title}</h2>
      ${imgRows}
      <p>${project.description}</p>
    </div>
    <div class="mac-footer">
      <span style="font-size:10px;color:#666;">Stanley's Desk Â© 2024</span>
      ${project.link ? `<a class="mac-link" href="${project.link}" target="_blank" rel="noopener">â†— ${project.linkText || 'View Project'}</a>` : ''}
    </div>
  `;
  document.body.appendChild(win);

  // Attach events
  hotspot.addEventListener('mouseenter', () => {
    activeHotspot = hotspot;
    cursor.classList.add('pointing');
    hoverLabel.style.display = 'block';
    hoverLabel.textContent = hotspot.dataset.label;
    hotspot.classList.add('hovered');
    spawnBurstAt(hotspot);
  });
  hotspot.addEventListener('mousemove', e => {
    hoverLabel.style.left = (e.clientX + 20) + 'px';
    hoverLabel.style.top = (e.clientY - 10) + 'px';
  });
  hotspot.addEventListener('mouseleave', () => {
    activeHotspot = null;
    cursor.classList.remove('pointing');
    hoverLabel.style.display = 'none';
    hotspot.classList.remove('hovered');
  });
  hotspot.addEventListener('click', () => openWindow(project.id, hotspot));

  win.querySelector('.mac-close-btn').addEventListener('click', () => closeWindow(project.id));

  // Draggable
  const tb = win.querySelector('.mac-titlebar');
  let isDragging = false, startX, startY;
  tb.addEventListener('mousedown', e => {
    if (e.target.classList.contains('mac-close-btn')) return;
    isDragging = true;
    const rect = win.getBoundingClientRect();
    win.style.transform = 'none';
    win.style.left = rect.left + 'px';
    win.style.top = rect.top + 'px';
    startX = e.clientX - rect.left;
    startY = e.clientY - rect.top;
    e.preventDefault();
  });
  document.addEventListener('mousemove', e => {
    if (!isDragging) return;
    win.style.left = (e.clientX - startX) + 'px';
    win.style.top = (e.clientY - startY) + 'px';
  });
  document.addEventListener('mouseup', () => { isDragging = false; });
}

PROJECTS.forEach(buildProjectFromConfig);
</script>
</body>
</html>
